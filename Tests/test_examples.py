from Examples import *
import pytest

def test_mat_creation():
    output = mat_creation()
    assert str(type(output)) == "<class 'pymecht.MatModel.MatModel'>"
    assert len(output.models) == 2
    assert output.param_names == [{'k1_0': 'k1', 'k2_0': 'k2', 'k3_0': 'k3'}, {'mu_1': 'mu'}]
    assert output.parameters == {'k1_0': 10.0, 'k2_0': 10.0, 'k3_0': 0.1, 'mu_1': 1.0}
    assert list(output.models[0].fiber_dirs[0]) == [1., 0., 0.]

def test_unixex():
    output = unixex()
    assert output[0] == pytest.approx([1.0, 1.1111111111111112, 1.2222222222222223, 1.3333333333333333, 1.4444444444444444, 1.5555555555555556, 1.6666666666666665, 1.7777777777777777, 1.8888888888888888, 2.0])
    assert output[1] == pytest.approx([0.0, 3.889237649923175, 24.210969202431325, 306.3625384491437, 12166.895534560083, 2130684.6891950294, 2322650211.527586, 22534357192278.957, 2.830189006942182e+18, 6.826789038537727e+24])
    assert output[2] == pytest.approx([0.0, 0.2222222222222222, 0.4444444444444444, 0.6666666666666666, 0.8888888888888888, 1.1111111111111112, 1.3333333333333333, 1.5555555555555554, 1.7777777777777777, 2.0])
    assert output[3] == pytest.approx([1.000000000000003, 1.0096555981502184, 1.0189205712648177, 1.0277536117002184, 1.036130527984696, 1.0440426440692123, 1.0514940560882118, 1.0584984779904174, 1.0650762207778208, 1.0712516151400189])

def test_biaxex():
    output = biaxex()
    assert output[0] == pytest.approx([1.0, 1.1111111111111112, 1.2222222222222223, 1.3333333333333333, 1.4444444444444444, 1.5555555555555556, 1.6666666666666665, 1.7777777777777777, 1.8888888888888888, 2.0])
    assert output[1] == pytest.approx([0.254101373152648, 0.4283530730656771, 52.36024847136841, 7.605019052701357, 178192.56555630412, 24004.871190623522, 1841622820725.367, 253780758993.39755, 2.079354372883468e+24, 2.869974506675743e+23])
    assert output[2] == pytest.approx([0.0, 0.2222222222222222, 0.4444444444444444, 0.6666666666666666, 0.8888888888888888, 1.1111111111111112, 1.3333333333333333, 1.5555555555555554, 1.7777777777777777, 2.0])
    assert output[3] == pytest.approx([0.9649576634391019, 1.0739485623031386, 1.0008208331098385, 1.1733660460332205, 1.0044509001685087, 1.2829357327009965, 1.006445307545602, 1.3843445169845912, 1.0073732969995206, 1.4760209149414139])

def test_validate_tube():
    output = validate_tube()
    assert output[0] == pytest.approx(output[1])
    assert output[2] == pytest.approx(0.6702771145876144)

# def test_artery0Dmodel():
    # assert artery0Dmodel() == None

def test_randomex():
    assert randomex() == None